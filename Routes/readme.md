Veri Hazırlanması
Veri hazırlanması sürecinde öncelikli olarak veri seçimi yapılır. Verinin tamamını kullanmak yerine, parçalara bölünüp anlamlı bir bütün üzerinden yola çıkılması, doğru bir uygulama olacaktır. Bu esnada hangi verilere ihtiyaç duyulduğu ve hangilerinin kullanılacağı belirlenir. Veri ön işleme süreci ise çalışacağımız veri dizisinin içerisindeki eksik alanlar önceki örnekler dikkate alınarak doldurulabilir. Birbirinin aynı olan veriler, veri dizisinden çıkartılabilir. Eğer yeterince büyük bir veri dizisine sahip değilsek, bu eksik alanların oluştuğu veri sütununu tamamen hesaplamadan çıkarılması mantıklı olacaktır. Verilerin ayrıştırılması veya birleştirilerek farklı özellikler elde edilmesi de, modelin doğruluğu için avantaj sağlamaktadır. Sayısal değerleri ölçeklendirme yoluna gidilebilir. Farklı parametreler, örneğin tarih verisi, veri dizisine eklenebilir.
İncelenecek uygulamada  İstanbul Boğazı’ndan Marmara denizine doğru geçiş yapan gemiler üzerinde çalışma yapılacaktır. Veri dizisindeki gemiler yaklaşık 6 saatlik aralıklarla konum bilgisi göndermektedir. Toplam 50 gemiye ilişkin veriler mevcuttur. Bu gemilerden aldığımız enlem boylam ve zaman gibi bilgileri kullanılarak, gemilerin hangi rotayı izledikleri, hangi zamanda nerede bulundukları tahminlenecektir. Burada kullanılan verilerin daha yüksek sayıda olması, modellerin daha yüksek değerlerde tahminleme yapabilmesine olanak sağlayacağı için, geçmiş dönemlere ait tutulan veriler, yapılacak olan tahminler için çok değerli olmaktadır. 
Regresyon Algoritmaları
Makine öğrenmesinin temeli algoritmalara dayanmaktadır. Uygun bir model seçimi bu noktada önem taşımaktadır. Uygun bir modele, uygun bir algoritma seçiminin yapılması modelin başarı şansını arttırmaktadır. Regresyon, bir bağımlı değişken ile diğer bağımsız değişkenler arasındaki ilişkiye göre, bu ilişki kapsamında çeşitli tahminler ortaya koymayı sağlayan istatistiksel bir ölçümdür. Örneğin bir çocuğun boyu yılda yaklaşık olarak 3 santim artarsa, indirimden, gelecek sene giymesi koşulu ile alınacak, bir kıyafet için ölçüleri, regresyon denklemi ile modellenebilir. Aslında gerçek hayatta karşılaşılan birçok problem, bu çeşit bir denklemle modellenebilmektedir. Geçmiş dönemlerdeki verilerin, gelecek dönemdeki davranışların göstergesi olarak kullanılması, her alanda işlerimizi kolaylaştırmaktadır. Farklı regresyon algoritmalarını şöyle tanımlanabilir:
Doğrusal İlerleme (Linear Regression) Algoritması : 
İstatistikte doğrusal regresyon,  sayısal bir değer ile bir veya daha fazla açıklayıcı değişken arasındaki ilişkiyi modellemeye sağlayan doğrusal bir yaklaşımdır. Açıklayıcı bir değişkenin durumuna basit doğrusal regresyon denir; birden fazlası için uygulanan sürece çoklu doğrusal regresyon denir [20]. Sistemdeki varolan konum bilgisi verilerinin kullanılarak, bir geminin gelecekteki durumuna istinaden, harita üzerinde bulunabileceği konumun hesaplanması amaçlanmaktadır. Uygulamamızda Python dili kullanarak basit bir makina öğrenmesi testi yapılacaktır. Bunun için öncelikle Python kütüphanelerinden kullanacak olan fonksiyonların sisteme çağrılması gerekmektedir. İlk çağrılan kütüphane Pandas’tır. Bu kütüphane ilişkili ve etiketli verilerin analiz edilmesini sağlayan bir kütüphanedir. İki boyutlu verilerin aynen veritabanındaki tablo yapısı gibi görselleştirilmesini sağlar. Bu verilere sütun eklenilmesi, çıkartılması ile birlikte verilerdeki tutarsızlıkları düzeltilmesine yardımcı olabilecek bir çok ek fonksiyon da sağlamaktadır. Numpy kütüphanesi ise, bilimsel hesaplamalar yapılmasını sağlayan matematiksel bir kütüphanedir. Folium görselleştirme işlemleri için enlem ve boylam değerlerini harita üzerinde gösterilmesini sağlayan bir kütüphanedir. Matplotlib ise veri görselleştirmelerinde kullanılan 2 veya 3 boyutlu çizimler yapılmasını sağlayan bir kütüphanedir. Scikit Learn ise yapay öğrenmede en çok kullanılan kütüphanelerden biri olup içerisinde doğrusal regresyon, karar ağaçları ve rasgele öğrenme kütüphanelerini barındırır. Haritalama arayüzünde kullandığımız bir diğer kütüphane olan İpyleaflet, leaflet javascript kütüphanesinin, Jupyter Notebook arayüzünde kullanılabilmesi için bir köprü oluşturur ve yapılan işlemlerin harita üzerinde gösterilebilmesine olanak sağlar. GeoPandas, Python dilinde coğrafi bilgi sistemlerinde kullanılan geometrik işlemleri gösterebilmek için kullanılan açık kaynaklı bir kütüphanedir.  
 
Şekil 4.3 Hazırlamış olduğumuz veri dizisinin  tek bir gemiye indirgenmesi	
Burada virgülle ayrılmış değerler dosyası (csv), formatındaki verilerin içeriğini ekranda görüntülenebilmektedir.  Buna göre ShipId ve ShipmemberNo alanları geminin tanımlayıcı bilgileridir. Enlem ve boylam bilgilerinin yanında konum alma tarihinide veri dizisinde yer almaktadır. Bu veri dizisindeki tek bir geminin verilerini alınıp, bazı algoritmalar kullanarak, bu gemiye ilişkin rota değerlerini tahmin edilecektir. Burada amaç verileri ve kullanılan algoritmaların basit bir şekilde ekranda gösterilmesi ve bu sayede kolayca anlaşılmasını sağlamaktır. Sonrasında çok daha fazla veri ile farklı algoritmalar sayesinde, bir geminin  gidebileceği muhtemel rotalar tahminlenebilecektir.
 
Şekil 4.4  2253-1 Nolu geminin konum bilgilerinin enlem ve boylam değerleri dağılımı 	
 
Şekil 4.5 2253-1 Nolu geminin konum koordinatlarının gerçek harita üzerindeki görünümü
Gemi İstanbul Boğazı’ndan  geçerek Mudanya Limanı’nda demirlemiştir.
 
Şekil 4.6- Gemi konum bilgisine Doğrusal İlerleme Algoritmasının uygulanması
 
Şekil 4.7 2253-1 Nolu geminin tahminleme sonuçları
R kare değerleri 0-100 arasında olup, sıfır değeri diğer değişkenler arasındaki ilişki olmadığının göstergesidir. 100 değerine yaklaşması ise kuvvetli bir ilişki olduğunun göstergesidir. Dolayısıyla ekran çıktısında seçmiş olduğumuz değerin 1’e yaklaşmış olması modelin başarılı olduğunu ifade etmektedir.
Polinomsal İlerleme (Polynomial Regression) Algoritması: Değişkenler arasında doğrusal bir ilişki olmadığı, poligonal bir ilişki olduğu durumlarda kullanılmaktadır. Yukarıdaki örneğimizi ele alırsak ve bu örneği polinomal regresyona tabi tutarsak sonuçlar şu şekilde olacaktır.
 
Şekil 4.8 Gemi konum bilgisine Polinomsal İlerleme  Algoritması uygulanmış hali
Bundan sonraki aşamada modelin r kare değerine göre doğruluk oranını ekranda görüntülenmesi gerekmektedir. Böylece modelin başarı oranı hakkında bir değer elde etmiş olacağız.
 
Şekil 4.9 Polinomsal İlerleme  başarı oranı
Dikkat edilecek olursa Doğrusal İlerleme Algoritmasına göre, Polinomsal İlerleme Algoritması tahminlemede daha başarılı sonuçlar vermektedir. Burada tek bir değer kullanılmasındaki amaç uygulanan algoritmaların mantığının kolay anlaşılmasını sağlamaktır. Daha fazla veri kullanıldığında çok daha sağlıklı veriler elde edilecektir. 
 
Şekil 5.1 Tüm veri dizisinin harita üzerindeki dağılımı
K-Means (K-Ortalamalar) Algoritması: Bu algoritma denetimsiz ve kümeleme algoritmasıdır. Çeşitli kümeleme yöntemleri vardır. K ortalamalar algoritması, en verimli kümeleme yöntemlerinden birisidir. N veri dizisinde, k adet farklı küme yer alır. Her kümenin  k algoritmalar kümesi olarak adlandırılan benzersiz bir ortalama ağırlık merkezi vardır. Benzer olan elemanlar belirli bir kümenin ağırlık merkezinde yer alırken, benzersiz olan elemanlar diğer kümelerde yer alırlar. Bu süreç belirli bir süre tekrarlanır [21].
 
Şekil 5.2 Veri dizisine K Ortalamalar algoritmalarının uygulanması
 
Şekil 5.3 Gemilerin koordinatlarına K Ortalamalar Algoritması uygulanması
Uygulamada k parametresi olarak 5 değerini belirlenmiştir. Buna bağlı olarak 5 adet kümelenme merkezi karşımıza çıkmaktadır.
 
Şekil 5.4 Bölgede bulunan rastgele bir geminin tahmini rotasının hesaplanması 
Buna göre sınıflandırma modeli kullanılarak İstanbul Boğazı’nı terk eden bir geminin anlık olarak konum verilerinin modele gönderilmesi ile gideceği güzergah tahmin edilebilmektedir. Bu tahmin bir uygulama arayüzü kullanarak da, son kullanıcılarla paylaşılabilir. Daha istatistiksel bir sonuç için yüzde belirtilerek, geminin nereye gidebileceği bilgisi net olarak son kullanıcılara ulaştırılabilir. K değerininin değiştirilmesi ile farklı sonuçlar elde edilir. Örneğin K değeri arttırıldığında, daha fazla merkez noktası ortaya çıkacaktır. Bu değerin gereğinden fazla arttırılması ile tahminleme oranları düşecektir. Gereğinden az olması halinde ise, çok genel sonuçlar  elde edilir. Dolayısıyla sistemin kararlı hale getirecek noktayı belirlemek yazılım uzmanı veya, eğer uygulama parametrikse, son kullanıcıya bağlıdır.
 
Şekil 5.5 Örnek bir  enlem boylam değeri ile tahmini rota belirlenmesi
Model
Veri madenciliği analitik bir süreç olup büyük miktarda veri içerisinde değişkenler arasındaki  uyumu  veya sistematik ilişkileri bulmayı amaçlar. Sonrasında bu bulguları alt veri kümelelerin uygulayarak doğrular [22]. Makine öğrenmesindeki amaç, varolan verilerden ilişkilier elde edilmesi ve bu ilişkiler kullanılarak doğru  tahminler yapılmasıdır. Bunun için de uygulama sonucu bir model elde edilir. Model girdilerle, çıktıların eşleşmesini sağlayan bir sistemdir. Burada örneğin bir emlakçı düşünelim ve girdiler evin bulunduğu semt ve oda sayısı olsun. Bu verileri kullanarak fiyat bilgisi elde edilmesi amaç olsun. Burada evin konumu ve oda sayısı ile evin fiyatı arasındaki ilişkiyi açığa çıkartılması kritik noktadır. İşte bu ilişkiyi ortaya çıkaran oluşturmuş olduğumuz modeldir. Makine öğrenmesinde tahminleme yapabilmek için verileri eğitim ve test dizileri olarak ikiye ayıralım. Modeli eğitim verilerine göre eğitiriz. Bu işlem neticesinde veriler aşırı öğrenebilir veya eksik öğrenebilir. Aşırı öğrenme durumunda model bir nevi ezberleme durumuna geçmiş olacaktır. Dolayısıyla böyle bir durumda değişik bir senaryoyla karşılaştığımızda tahminlerin çok zayıf ve kötü olma ihtimali yüksektir. Bunun haricinde yeteri kadar eğitime sokulmayan veriler de, aynı şekilde düşük skorlar üreteceği için; her iki durumdan da kaçınılması gerekmektedir. Aşırı öğrenme problemi için aşağıdaki yöntemler uygulanmaktadır:
•	Öznitelik sayısını azaltmak için birbiriyle gereğinden fazla ilişkili kolonların silinmesi gerekebilir.
•	Daha fazla veri eklenmesi ile eğitim dizisine çeşit kazandırılması amacıyla, farklı verilerin eklenmesi gerekebilir.
•	Düzenleme modelinde ağırlığı yüksek olan değişkenlerin, etki oranları azaltılabilir.
•	Yetersiz öğrenme durumunda ise yapılması gereken, ek bağımsız değişkenler ekleyerek modeli yeniden oluşturmak olmalıdır.
Makine öğrenmesinde başarıya ulaşmak için veriler ön işlemlerden geçirilmektedir. Bu ön işlem süreci, yüksek doğruluktaki tahminlemeye ulaşmak için kilit adımdır. Bu süreç model seçiminden çok daha önemlidir. Ön işleme sürecinin ardından veriler eğitim ve test verisi olarak ikiye bölünür. Eğitim verisi genellikle tüm verilerin %75’lik kısmını kapsar. Verileri eğittikten sonra farklı modellerde elde edilen skor değerleri incelenir. Bu sayede verileri tahminlemedeki doğruluk oranları yakalanabilmektedir.
 
Şekil 5.6 Makine öğrenmesi model kurgulanması 
Rastgele Orman Algoritması (Random Forest Regressor)
L. Breiman tarafından 2001 yılında önerilen rastgele orman algoritması, genel amaçlı bir sınıflandırma ve regresyon yöntemi olarak son derece başarılı bir yaklaşımdır. Birden fazla sayıda karar ağacını birleştiren ve tahminlerini ortalamayla bir araya getiren yaklaşımdır, değişken sayısının gözlem sayısından büyük olduğu durumlarda daha yüksek performans sergiler [23].
 
Şekil 6.1 Rastgele Orman Algoritması örneği
Farklı örnek veri dizileriyle farklı modellemeler kullanmak mümkün olmakla birlikte, uygun modeli bulunması için bazı ek çalışmalar yapılması gerekmektedir. Örneğin elimizdeki mevcut veri dizisinde, limanlara uğramadan doğrudan çanakkale boğazına geçen belirli gemiler için tahminleme yapılması istenirse bu durumda bu gemilerin konum bilgilerine göre dağılımını aşağıdaki gibi gösterilebilir. Buradaki veri bir maden olarak düşünülebilir. Bu ham halde bulunan verinin, değerli hale getirilmesi için birtakım işlemlerden geçirmek gerekmektedir. Tutarsız veriler, tekrar eden veriler, boş veriler modeli olumsuz etkileyeceği için bu verilerin temizlenmesi gerekmektedir. Hatalı veya formata uymayan verinin de aynı şekilde çıkarılması gerekmektedir. Benzer özellikteki veriler birleştirilebilir veya tam tersi, bazı birleşik verileri  daha doğru sonuçlar elde etmek için ayrılabilir.
 Burada belirli bir rotayı takip eden gemilerden, normalin dışında hareket sergileyen, örneğin denizde birkaç hafta aynı noktada demirleyen veya konum bilgisi iletimini kesen veya herhangi bir nedenle daha önce hiç yapmamış olmasına rağmen, rotasını bir limana çeviripi orada demirleyen gemileri veri setinden elenmesi tahminler konusunda daha doğru bir bilgi sağlayacaktır. Bir başka önemli nokta ise, eğer bu gemi boğazdan 100 sefer geçiş yapmış ve hiçbirisinde  durmamış, sadece acil bir durum sebebiyle bir kez limana uğramış olsun. Bu %1 lik oranın çıkarılması tahminlerimizdeki doğruluk miktarını arttıracaktır.
 
Şekil 6.2 Limana uğramayan gemilerin geçiş rotaları
Yukarıdaki örnekteki veri setimize Rastgele Orman Algoritması uygularsak çok yüksek bir doğrulukta rotamızı tahmin etme şansı bulabileceğiz. 
 
Şekil 6.3 Rastgele Orman Algoritması’nın veri dizisine uygulanması
Rastgele Orman Algoritması kullanılarak yüksek doğrulukta başarı oranıyla tahminleme yapılmıştır. Yine bir diğer örnekte Karar Ağaçları Algoritması kullanılmıştır. Buradaki algoritmanın mantığı ise konum bilgileri değerlerini belirli aralıklarla ayırmaktadır. Tahmin esnasında ise bir değer sorgulanıldığında bu aralıktaki yani eğitim sırasında öğrendiği ortalama değer elde edilmektedir. Dolayısıyla buradaki regresyon modeli kesiklidir. Yani belirli aralıkta istenen tahminler için aynı sonucu üretir.
 
Şekil 6.4 Doğrudan geçiş yapan gemilerin rotaları (kırmızı)  ve tahmin edilen rotalar (yeşil) 
Burada kırmızı ile işaretli noktalar enlem ve boylam değerleridir. Örnek veri dizisindeki bu değerler harita üzerinde gösterilmektedir. Uygulanan regresyon algoritmaları ile elde ettiğimiz tahmini değerleri de, ekran üzerinde yeşil noktalar olarak gösterilmektedir. Nokta dağılımlarına dikkat edilirse, burada tahmini değerler ile gerçek değerler arasında az bir fark bulunduğu gözlemlenebilmektedir. Bu sayede tahmini değerlerinde elde edilen doğruluk oranlarını da test edilmektedir. Farklı parametreler kullanılarak örnekler genişletilebilir. Zaman parametresi bu denklem içerisine katıldığında farklı türde sonuçlar elde edilebilmektedir. Ancak burada diğer önemli bir husus da, gemilerin yolculuk ettiği bölgelere göre bu tahminlerin farklılık göstermesi olacaktır. Buraya kadar olan bölümde tarih parametresi kullanılmamıştır. Tarih parametresinin de uygulamaya eklenmesiyle farklı özellikleri kullanarak tahminleme yapılabilecektir.
 
Şekil 6.5 Tarih parametresi eklenmiş veri dizisi  
Yeni bir veri dizisi yüklenerek, enlem boylam ve tarih parametreleri üzerinden işlem yapılacaktır. Bu uygulamada, bir özellikten bir çok farklı özellik türetilmesi yolu izlenecektir. Öncelikle enlem ve boylam değerlerini sayısal değerlere dönüştürülür. Tarih sütunu ise tarih formatına çevrilir. 
 
Şekil 6.6 Tarih verilerinin ayrılması (yıl, ay, gün, saat ve dakika) 
Tarih formatı parçalanarak yıl, ay, gün, saat ve dakika cinsinden parçalara dönüştürülmektedir. Türetilen bu verilerin birbirleriyle olan ilişkilerinin, doğru bir şekilde analiz edilmesi gerekmektedir. Tarih verilerinin belirli bir dönem aralığında alınması ise, veri dizisi içerisinde yapılan basit bir sorgulamayla mümkündür. Bu aşamadan sonra  Rasgele Orman Algoritması kullanılarak veriler eğitilmektedir. Belirlenen bir tarihe göre gemi konumlarının gelecekteki muhtemel konumlarının %90 üzerinde bir doğrulukla tahminlenmesi mümkün olmaktadır. 
 
Şekil 6.7 Verilen tarih parametresine göre rota tahminlenmesi 
Yolculuk yapılan gemi güzergahlarında, dairesel bir hareket yerine, daha doğrusal bir rota bu başarı yüzdesinin artmasındaki en öneml kriterlerden bir tanesidir. Birçok tahminleme yöntemi doğru bir şekilde kullanıldığında gemi çarpışması,operasyon verimliliği, anormallik tespiti konularında doğru bilgilendirmeler sunabilmektedir. 
